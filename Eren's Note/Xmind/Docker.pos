{"diagram":{"elements":{"leftChildren":[],"children":[{"parent":"root","children":[{"parent":"2cbc19d6a7009224","image":{"w":300,"h":94.83695652173914,"url":"https://cdn.processon.com/userId2-6678c9d617d8851b3a3b89e4?e=1719195623&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:g3jqUGxCS_yi4RkqCtM43CxIE8s=","direction":"up"},"children":[],"id":"f04fe5a82ed60880","title":""}],"id":"2cbc19d6a7009224","title":"是什么？"},{"parent":"root","children":[{"parent":"ac0e1e9ee001d959","children":[{"parent":"d2a6d64b4ed1d307","children":[],"id":"f5bcc3ced579b11c","title":"yum install -y yum-utils"},{"parent":"d2a6d64b4ed1d307","children":[],"id":"9aef218ba7b98a7e","title":"yum install device-mapper-persistent-data -y"},{"parent":"d2a6d64b4ed1d307","children":[],"id":"db2ae3dfdcadb970","title":"yum install lvm2 -y"}],"id":"d2a6d64b4ed1d307","title":"系统工具"},{"parent":"ac0e1e9ee001d959","children":[{"parent":"a8e49c1603a1ac8f","children":[],"id":"811d6248d2183b43","title":"yum-config-manager&nbsp;--add-repo&nbsp;https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo"}],"id":"a8e49c1603a1ac8f","title":"添加软件源"},{"parent":"ac0e1e9ee001d959","children":[{"parent":"d1f33fcb17493b1f","children":[],"id":"b86565771131304e","title":"yum makecache fast"},{"parent":"d1f33fcb17493b1f","children":[],"id":"196ac999f3a7b6d2","title":"yum&nbsp;install&nbsp;docker-ce&nbsp;-y<br>"}],"id":"d1f33fcb17493b1f","title":"更新并安装 Docker-CE"},{"parent":"ac0e1e9ee001d959","children":[{"parent":"fe117709abfe32c1","children":[],"id":"5928c318781ff287","title":"service docker start<br>"}],"id":"fe117709abfe32c1","title":"启动Docker服务"},{"parent":"ac0e1e9ee001d959","children":[{"parent":"cb9d81453ffcc6fb","children":[],"id":"b357b81466990665","title":"docker version"}],"id":"cb9d81453ffcc6fb","title":"查看docker版本"},{"parent":"ac0e1e9ee001d959","children":[{"parent":"46ee327598c3037a","children":[],"id":"faeab7d2eefab67b","title":"sudo mkdir -p /etc/docker<br>sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'<br>{<br>&nbsp; \"registry-mirrors\": [\"xxx\"]<br>}<br>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker"}],"id":"46ee327598c3037a","title":"配置镜像加速器"},{"parent":"ac0e1e9ee001d959","children":[{"parent":"e98ec062d76f7a95","children":[{"parent":"6b5c1e81c211b44a","children":[],"id":"58e9c6e4b27eef3b","title":"vim /etc/sysctl.conf"},{"parent":"6b5c1e81c211b44a","children":[],"id":"35eded0a333b3b73","title":"net.ipv4.ip_forward=1<br>"}],"id":"6b5c1e81c211b44a","title":"修改配置"},{"parent":"e98ec062d76f7a95","children":[{"parent":"9a9e46c4ee3a6ca3","children":[],"id":"8a3390fd499ed250","title":"sysctl -p"}],"id":"9a9e46c4ee3a6ca3","title":"配置生效"},{"parent":"e98ec062d76f7a95","children":[{"parent":"ca5506f8a3edbb53","children":[],"id":"df5cfdf7bf6d08dd","title":"systemctl restart network"}],"id":"ca5506f8a3edbb53","title":"重启网络服务"},{"parent":"e98ec062d76f7a95","children":[{"parent":"54bbb49a6773853e","children":[],"id":"e82b10a3816dff0b","title":"systemctl restart docker"}],"id":"54bbb49a6773853e","title":"重启dokcer服务"}],"id":"e98ec062d76f7a95","title":"网络优化"}],"id":"ac0e1e9ee001d959","title":"安装"},{"parent":"root","children":[{"parent":"a6b4af1d5d668124","children":[{"parent":"8a1629a4e2ef9233","children":[{"parent":"b8f453d556592f59","children":[],"id":"bd062666624ef706","title":"docker version"}],"id":"b8f453d556592f59","title":"查看版本详细"},{"parent":"8a1629a4e2ef9233","children":[{"parent":"96b909c5adfa1196","children":[],"id":"e5caab694a89ad9b","title":"docker -v"}],"id":"96b909c5adfa1196","title":"查看版本简要"},{"parent":"8a1629a4e2ef9233","children":[{"parent":"1059cec42e5002d8","children":[],"id":"e5bbb10b42e06e97","title":"systemctl start docker"}],"id":"1059cec42e5002d8","title":"启动docker&nbsp;"},{"parent":"8a1629a4e2ef9233","children":[{"parent":"fc8576b7b2e9d29a","children":[],"id":"41cfbfa7f63fdaff","title":"systemctl stop docker"}],"id":"fc8576b7b2e9d29a","title":"关闭docker"},{"parent":"8a1629a4e2ef9233","children":[{"parent":"2249bc1b8965740b","children":[],"id":"5d17182269589555","title":"systemctl enable docker"}],"id":"2249bc1b8965740b","title":"设置开机启动"},{"parent":"8a1629a4e2ef9233","children":[{"parent":"313b5a57ee9834c2","children":[],"id":"eee5be7750afaf89","title":"service docker restart"}],"id":"313b5a57ee9834c2","title":"重启docker服务"},{"parent":"8a1629a4e2ef9233","children":[{"parent":"7c3a5a359906462f","children":[],"id":"b58c1feb8cae0b2d","title":"service docker stop"}],"id":"7c3a5a359906462f","title":"关闭docker服务&nbsp;"}],"id":"8a1629a4e2ef9233","title":"服务"},{"parent":"a6b4af1d5d668124","children":[{"parent":"545ec6100e9d93a9","children":[{"parent":"0da3d55f5534a45f","children":[],"id":"0f05e8bf1984c2a9","title":"docker search [image]"}],"id":"0da3d55f5534a45f","title":"检索镜像"},{"parent":"545ec6100e9d93a9","children":[{"parent":"e623cab4eaeeb7df","children":[],"id":"93244ace52d08d81","title":"docker images&nbsp;&nbsp;"},{"parent":"e623cab4eaeeb7df","children":[],"id":"484bf64898d7be30","title":"docker image ls"}],"id":"e623cab4eaeeb7df","title":"查看镜像"},{"parent":"545ec6100e9d93a9","children":[{"parent":"81dec8bc35e9d1b6","children":[],"id":"cbfa79542eaeae5e","title":"docker inspect [image id]"}],"id":"81dec8bc35e9d1b6","title":"镜像详情"},{"parent":"545ec6100e9d93a9","children":[{"parent":"5d89efb0ff1d95c5","children":[],"id":"534229a1e75b8517","title":"docker pull&nbsp;[image]"}],"id":"5d89efb0ff1d95c5","title":"拉取镜像"},{"parent":"545ec6100e9d93a9","children":[{"parent":"d6433013bb23f74c","children":[],"id":"f6dce8d944120109","title":"docker tag nginx:latest nginx:web"}],"id":"d6433013bb23f74c","title":"添加标签"},{"parent":"545ec6100e9d93a9","children":[{"parent":"f0698c486bf68fbd","children":[],"id":"923a43f7652cba18","title":"docker rmi&nbsp;&nbsp;"},{"parent":"f0698c486bf68fbd","children":[],"id":"d1d7ca15ab399229","title":"docker image rm"}],"id":"f0698c486bf68fbd","title":"删除镜像"},{"parent":"545ec6100e9d93a9","children":[{"parent":"ad7c9a35c72eea22","children":[],"id":"6b4b822d46debafb","title":"docker save [images] &gt; image_name"}],"id":"ad7c9a35c72eea22","title":"导出镜像"},{"parent":"545ec6100e9d93a9","children":[{"parent":"b1104cc85790f56d","children":[],"id":"b293eac9d2564849","title":"docker load -i&nbsp;image_name"}],"id":"b1104cc85790f56d","title":"导入镜像"}],"id":"545ec6100e9d93a9","title":"镜像"},{"parent":"a6b4af1d5d668124","children":[{"parent":"d3de9fc1e5300699","children":[{"parent":"68dca4b198f0936e","children":[],"id":"6d851874aed0269a","title":"docker create [image]"}],"id":"68dca4b198f0936e","title":"创建容器"},{"parent":"d3de9fc1e5300699","customWidth":87,"children":[{"parent":"7073960969da2671","children":[],"id":"8244779a402b1199","title":"docker run&nbsp;[image]"}],"id":"7073960969da2671","title":"创建并启动容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"3408881a67f1dbef","children":[],"id":"e7b96eeae6445658","title":"docker start&nbsp;[container]"}],"id":"3408881a67f1dbef","title":"启动容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"7c9c82ea921115e7","children":[{"parent":"5302f9d50833c4f4","children":[],"id":"8fba6b0cde33c840","title":"docker ps"},{"parent":"5302f9d50833c4f4","children":[],"id":"e2e9bd2410a65612","title":"docker container ls"}],"id":"5302f9d50833c4f4","title":"列出运行容器"},{"parent":"7c9c82ea921115e7","children":[{"parent":"09a1a480c48e6e2d","children":[],"id":"fdb567638fb036ad","title":"docker -ps -a"},{"parent":"09a1a480c48e6e2d","children":[],"id":"8c91bd16a9f82a90","title":"docker container ls -a"}],"id":"09a1a480c48e6e2d","title":"列出所有容器"}],"id":"7c9c82ea921115e7","title":"查看容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"cb5abe085b7f8039","children":[],"id":"d679c1bab02e87e1","title":"docker stop&nbsp;[container]"}],"id":"cb5abe085b7f8039","title":"终止容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"9a469aa5aa1a1b83","children":[],"id":"844e9e28b44d7e1a","title":"docker&nbsp; restart&nbsp;[container]"}],"id":"9a469aa5aa1a1b83","title":"重启容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"5b91bdf16643bab0","children":[],"id":"20b904439232aa52","title":"docker attach&nbsp;[container]"},{"parent":"5b91bdf16643bab0","children":[],"id":"5e8b7496c4694fa6","title":"docker exec -it [container] bash"}],"id":"5b91bdf16643bab0","title":"进入容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"ae43ebe920e72a95","children":[],"id":"caad74f0d557e74b","title":"docker export [container] &gt; container_name"}],"id":"ae43ebe920e72a95","title":"导出容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"5c40ecf0296b37ea","children":[{"parent":"5852c1a7be14c8f4","children":[],"id":"c0170ca5f059a103","title":"cat centos_c | docker import - nginx:web"}],"id":"5852c1a7be14c8f4","title":"docker import"}],"id":"5c40ecf0296b37ea","title":"导入容器快照"},{"parent":"d3de9fc1e5300699","children":[{"parent":"02d8f2e5b70f8bfa","children":[],"id":"e232875aa5293f01","title":"docker rm&nbsp;[container]"},{"parent":"02d8f2e5b70f8bfa","children":[],"id":"996b8ff6cc522fab","title":"docker container rm&nbsp;[container]"},{"parent":"02d8f2e5b70f8bfa","children":[{"parent":"dea5c49c784d2a28","children":[],"id":"a8e317b9dfc42db2","title":"docker ps -a | awk '{print \"docker rm \"$1}' | bash"}],"id":"dea5c49c784d2a28","title":"批量删除"}],"id":"02d8f2e5b70f8bfa","title":"删除容器"},{"parent":"d3de9fc1e5300699","children":[{"parent":"2883635eb0d37fa0","children":[],"id":"35b32ec486c7041d","title":"docker logs [container]"}],"id":"2883635eb0d37fa0","title":"查看日志"}],"collapsed":false,"id":"d3de9fc1e5300699","title":"容器"},{"parent":"a6b4af1d5d668124","children":[{"parent":"79d9dc9f9a5b78bc","children":[{"parent":"6794ec2c723bb235","children":[],"id":"7fd8aed452754271","title":"创建容器默认连接的模式，分配ip，创建虚拟网卡，连接docker0虚拟网桥，通过docker0网桥以及iptables nat表配置于宿主机通信"}],"id":"6794ec2c723bb235","title":"bridge"},{"parent":"79d9dc9f9a5b78bc","children":[{"parent":"cf404a7c1f0e35d2","children":[],"id":"446c4eb85c1ec363","title":"容器不会虚拟出自己的网卡，不会配置自己的IP，而是使用宿主机IP和端口"}],"id":"cf404a7c1f0e35d2","title":"host"},{"parent":"79d9dc9f9a5b78bc","children":[{"parent":"5bb61df4adae542c","children":[],"id":"ff613debdcf17299","title":"关闭网络功能"}],"id":"5bb61df4adae542c","title":"none"},{"parent":"79d9dc9f9a5b78bc","children":[{"parent":"1b9460b381a73b7f","children":[{"parent":"59f84094d9a026cf","children":[],"id":"64f2a48e889512f8","title":"docker network create --subnet=172.18.0.0/24 mynetwork"}],"id":"59f84094d9a026cf","title":"创建网络资源"},{"parent":"1b9460b381a73b7f","children":[{"parent":"ede0c8025cde69bf","children":[],"id":"b63d0d2e4f70f5ca","title":"docker run -itd --name test1 --net mynetwork --ip 172.18.0.18 centos:7 /bin/bash"}],"id":"ede0c8025cde69bf","title":"使用资源给容器指定地址"}],"collapsed":false,"id":"1b9460b381a73b7f","title":"自定义网络"}],"id":"79d9dc9f9a5b78bc","title":"网络"}],"id":"a6b4af1d5d668124","title":"基本操作"},{"parent":"root","children":[{"parent":"ba94dd5ee742bb63","children":[],"id":"15862025426813f8","title":"镜像制作的工具"},{"parent":"ba94dd5ee742bb63","children":[{"parent":"d94149be089581b7","children":[{"parent":"44b5034720e23203","children":[],"id":"d3c1bb983881c7d0","title":"创建工作目录"},{"parent":"44b5034720e23203","children":[{"parent":"f202c0f80d3d8a61","children":[{"parent":"c07a357d55a6c449","children":[],"id":"2180de319d5dec20","title":"#基于基础镜像<br>FROM centos:7<br>#维护镜像的用户信息<br>MAINTAINER This is project apache<br>#镜像操作指令安装Apache<br>RUN yum -y update<br>RUN yum -y install httpd<br>#开启80端口<br>EXPOSE 80<br>#复制网站首页文件<br>ADD index.html /var/www/html/index.html<br>#将脚本复制到镜像中<br>ADD run.sh /run.sh<br>RUN chmod 755 /run.sh<br>#启动容器<br>CMD [\"/run.sh\"]<br>"}],"id":"c07a357d55a6c449","title":"vim Dockerfile"}],"id":"f202c0f80d3d8a61","title":"创建dockerfile"},{"parent":"44b5034720e23203","children":[{"parent":"122d017f780526da","children":[{"parent":"e2f548c29ad168a1","children":[],"id":"09ff87c45725046a","title":"#!/bin/bash<br>rm -rf /run/httpd/*<br>exec /usr/sbin/apachectl -D FOREGROUND<br>"}],"id":"e2f548c29ad168a1","title":"vim run.sh"}],"id":"122d017f780526da","title":"创建服务启动脚本"},{"parent":"44b5034720e23203","children":[{"parent":"f491a8f77c234c32","children":[],"id":"cfeb98dcf9eb6827","title":"vim index.html"}],"id":"f491a8f77c234c32","title":"创建默认首页"},{"parent":"44b5034720e23203","children":[{"parent":"447ebcb21b582708","children":[],"id":"10bcd0a0e42d5332","title":"docker build -t httpd.centos ."}],"id":"447ebcb21b582708","title":"构建镜像"},{"parent":"44b5034720e23203","children":[{"parent":"c11d29acbbf1f78b","children":[],"id":"7a0739ef4dac0238","title":"docker run -d -p 1217:80 httpd.centos"}],"id":"c11d29acbbf1f78b","title":"启动容器"},{"parent":"44b5034720e23203","children":[{"parent":"5d6b00ba27249638","children":[],"id":"ef08b3a1724879e3","title":"192.168.203.164:1217"}],"id":"5d6b00ba27249638","title":"查看浏览器"}],"id":"44b5034720e23203","title":"Apache镜像"},{"parent":"d94149be089581b7","children":[{"parent":"0dcd2a0cccc88a33","children":[],"id":"6e50f7576b30945a","title":"创建工作目录"},{"parent":"0dcd2a0cccc88a33","children":[],"id":"6e88393adf52ec94","title":"导入nginx软件包"},{"parent":"0dcd2a0cccc88a33","children":[{"parent":"774cf7ffc78478f5","children":[],"id":"688113ff5e125211","title":"#基础镜像<br>FROM centos:7<br>#用户信息<br>MAINTAINER this is nginx image<br>#添加环境包<br>RUN yum -y update<br>RUN yum -y install pcre-devel zlib-devel gcc gcc-c++ make<br>RUN useradd -M -s /sbin/nologin nginx<br>#解压源码包<br>ADD nginx-1.12.0.tar.gz /usr/local/src<br>WORKDIR /usr/local/src<br>#配置<br>WORKDIR nginx-1.12.0<br>RUN ./configure \\<br>--prefix=/usr/local/nginx \\<br>--user=nginx \\<br>--group=nginx \\<br>--with-http_stub_status_module &amp;&amp; make &amp;&amp; make install<br>#环境变量<br>ENV PATH /usr/local/nginx/sbin:$PATH<br>#暴露端口<br>EXPOSE 80<br>EXPOSE 443<br>RUN echo \"daemon off;\"&gt;&gt;/usr/local/nginx/conf/nginx.conf<br>#添加启动文件到容器中<br>ADD run.sh /run.sh<br>RUN chmod 755 /run.sh<br>#容器启动自动开启服务<br>CMD [\"/run.sh\"]<br>"}],"id":"774cf7ffc78478f5","title":"创建dockerfile"},{"parent":"0dcd2a0cccc88a33","children":[{"parent":"e480ad767c7225e1","children":[],"id":"cda85b1208d30f75","title":"#!/bin/bash<br>/usr/local/nginx/sbin/nginx"}],"id":"e480ad767c7225e1","title":"创建服务启动脚本"},{"parent":"0dcd2a0cccc88a33","children":[{"parent":"3249de53bfc47e62","children":[],"id":"c36195465cdd9f30","title":"docker build -t nginx:new ."}],"id":"3249de53bfc47e62","title":"构建镜像"},{"parent":"0dcd2a0cccc88a33","children":[{"parent":"b36613fff064d760","children":[],"id":"ed4b7a6c425957a9","title":"docker run -d -P nginx:new"}],"id":"b36613fff064d760","title":"启动容器"},{"parent":"0dcd2a0cccc88a33","children":[{"parent":"ab957c9a2d2b917f","children":[],"id":"349cac595e673068","title":"http://192.168.203.164:32769/"}],"id":"ab957c9a2d2b917f","title":"查看浏览器"}],"id":"0dcd2a0cccc88a33","title":"nginx镜像"},{"parent":"d94149be089581b7","children":[{"parent":"b32ec4442edfcc4e","children":[],"id":"37257dfc8c82ffaf","title":"创建工作目录"},{"parent":"b32ec4442edfcc4e","children":[],"id":"e28fe6b5d5d9e730","title":"导入tomcat软件包 和 jdk软件包"},{"parent":"b32ec4442edfcc4e","children":[{"parent":"599427c9dc2a3f1b","children":[],"id":"5b6140922a61cb2b","title":"#基础镜像<br>FROM centos:7<br>#用户信息<br>MAINTAINER this is tomcat image<br>#解压源码包<br>ADD jdk-8u91-linux-x64.tar.gz /usr/local<br>WORKDIR /usr/local<br>RUN mv jdk1.8.0_91 /usr/local/java<br>#环境配置<br>ENV JAVA_HOME /usr/local/java<br>ENV JAVA_BIN /usr/local/java/bin<br>ENV JRE_HOME /usr/local/java/jre<br>ENV PATH $PATH:/usr/local/java/bin:/usr/local/java/jre/bin<br>ENV CLASSPATH /usr/local/java/jre/bin:/usr/local/lib:/usr/local/java/jre/lib/cha<br>rsets.jar<br>#解压Tomcat到容器中<br>ADD apache-tomcat-8.5.16.tar.gz /usr/local<br>WORKDIR /usr/local<br>RUN mv apache-tomcat-8.5.16/usr/local/tomcat8<br>#暴露端口<br>EXPOSE 8080<br>#容器启动自动开启服务<br>ENTRYPOINT [\"/usr/local/tomcat8/bin/catalina.sh\",\"run\"]<br>"}],"id":"599427c9dc2a3f1b","title":"创建dockerfile"},{"parent":"b32ec4442edfcc4e","children":[{"parent":"b67bb9387ca9b98d","children":[],"id":"1ca34d00009f57cf","title":"docker build -t tomcat:centos ."}],"id":"b67bb9387ca9b98d","title":"构建镜像"},{"parent":"b32ec4442edfcc4e","children":[{"parent":"0bce589bcbd103e8","children":[],"id":"70f5f42d581ad537","title":"docker run -d --name tomcat01 -p 1216:8080 tomcat:centos"}],"id":"0bce589bcbd103e8","title":"启动容器"},{"parent":"b32ec4442edfcc4e","customWidth":65,"children":[{"parent":"4101ed234dd7bc15","image":{"w":300,"h":105.57377049180327,"url":"https://cdn.processon.com/userId2-667b75f5799a7b10808e4ec8?e=1719370758&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:yGodgdc_dn9Py1COtTrOP2bxME4=","direction":"up"},"children":[],"id":"1cb1721432fba0ef","title":""}],"id":"4101ed234dd7bc15","title":"查看浏览器"}],"collapsed":false,"id":"b32ec4442edfcc4e","title":"Tomcat镜像"}],"id":"d94149be089581b7","title":"镜像实战"},{"parent":"ba94dd5ee742bb63","children":[{"parent":"b34bcbd86f9b99c0","image":{"w":300,"h":192.9708222811671,"url":"https://cdn.processon.com/userId2-667a5f9c5feedb5772d3c366?e=1719299500&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:Jx84wyaPuQKY9weDxvee7OiCuf8=","direction":"up"},"children":[],"id":"ff09046452b8400b","title":""}],"id":"b34bcbd86f9b99c0","title":"操作指令"}],"id":"ba94dd5ee742bb63","title":"dockerfile制作镜像"},{"parent":"root","children":[{"parent":"32e9a62dceff82a4","children":[{"parent":"f79824064279d57b","children":[],"id":"651c454d71202d13","title":"docker pull registry"}],"id":"f79824064279d57b","title":"下载镜像"},{"parent":"32e9a62dceff82a4","children":[{"parent":"14c1db1a689d5601","children":[],"id":"008a846ef0ad507a","title":"vim /etc/docker/daemon.json"},{"parent":"14c1db1a689d5601","children":[{"parent":"f1760bd952a09a3d","children":[],"id":"afcdd02f0b8a34ae","title":"不要忘记逗号"}],"id":"f1760bd952a09a3d","title":"\"insecure-registeries\": [\"192.168.203.164:5000\"]"}],"id":"14c1db1a689d5601","title":"修改配置"},{"parent":"32e9a62dceff82a4","children":[{"parent":"97a97dd256402732","children":[],"id":"2490022ad869c7b5","title":"systemctl restart network"},{"parent":"97a97dd256402732","children":[],"id":"4c231bf9320ebf09","title":"systemctl restart docker"}],"id":"97a97dd256402732","title":"重启服务"},{"parent":"32e9a62dceff82a4","children":[{"parent":"7a6461b9a51d13f9","children":[],"id":"2ac66b867de3191d","title":"docker run -d -p 5000:5000 -v /data/registry:/tmp/registry registry"}],"id":"7a6461b9a51d13f9","title":"启动容器"},{"parent":"32e9a62dceff82a4","children":[{"parent":"47d35502d7cee7f1","children":[{"parent":"679d1a637e75e11d","children":[],"id":"3ae36ca86253b53f","title":"docker tag nginx:latest 192.168.203.164:5000/nginx<br>"}],"id":"679d1a637e75e11d","title":"打标签"},{"parent":"47d35502d7cee7f1","children":[{"parent":"70031d0fdebb1f28","children":[],"id":"167f7c00aa764a7a","title":"curl -XGET http://192.168.203.164:5000/v2/_catalog"}],"id":"70031d0fdebb1f28","title":"查看仓库"},{"parent":"47d35502d7cee7f1","children":[{"parent":"d719e93b3c9ffcbc","children":[],"id":"1d947b1c4a509e5f","title":"docker push 192.168.203.164:5000/nginx"}],"id":"d719e93b3c9ffcbc","title":"上传"}],"id":"47d35502d7cee7f1","title":"上传镜像"},{"parent":"32e9a62dceff82a4","children":[{"parent":"da0e80f18621c10b","children":[],"id":"ef7e417977a7924c","title":"docker pull 192.168.203.164:5000/nginx"}],"id":"da0e80f18621c10b","title":"私有下载"}],"id":"32e9a62dceff82a4","title":"镜像仓库"},{"parent":"root","children":[{"parent":"730232a6d9eef17e","children":[{"parent":"337a6f0f1782b835","children":[],"id":"dad9f33615612a84","title":"docker run -v /var/www:/data1 --name web1 -it centos:7 /bin/bash"}],"id":"337a6f0f1782b835","title":"挂载数据卷"},{"parent":"730232a6d9eef17e","children":[{"parent":"6f3c2627bd0f5f41","children":[],"id":"251d27f9e3ae3e88","title":"docker ps -a | awk '{print \"docker rm \"$1}' | bash"}],"id":"6f3c2627bd0f5f41","title":"批量删除容器"},{"parent":"730232a6d9eef17e","children":[{"parent":"0c3443a39905171e","children":[{"parent":"b0f65d69ff02b65f","children":[],"id":"94d5b81b503977a0","title":"docker run --name web100 -v /data1 -v /data2 -it centos:7 /bin/bash"}],"id":"b0f65d69ff02b65f","title":"存储容器"},{"parent":"0c3443a39905171e","children":[{"parent":"a24b4309f11c9751","children":[],"id":"8b0baa98dcb8c555","title":"docker run -it --volumes-from web100 --name db1 centos:7 /bin/bash"}],"id":"a24b4309f11c9751","title":"使用存储容器控件进行挂载到其他容器中使用"}],"id":"0c3443a39905171e","title":"数据卷容器"},{"parent":"730232a6d9eef17e","children":[{"parent":"f34aedc5dc9e681b","children":[{"parent":"ce7dbf0e70d10f3c","children":[],"id":"87216370cfb45edb","title":"docker run -itd -P --name web11 centos:7 /bin/bash"}],"id":"ce7dbf0e70d10f3c","title":"创建容器，保持UP状态"},{"parent":"f34aedc5dc9e681b","children":[{"parent":"eea954c39878f5f3","children":[],"id":"7954abce34051048","title":"docker&nbsp; run -itd -P --name web22 --link web11:web11 centos:7 /bin/bash"}],"id":"eea954c39878f5f3","title":"使用link关联对方容器，建立互联通信"}],"id":"f34aedc5dc9e681b","title":"容器互联"}],"id":"730232a6d9eef17e","title":"数据卷/数据卷容器"},{"parent":"root","children":[{"parent":"2c37a04242447d08","children":[{"parent":"17bba3633e0db487","children":[],"id":"14f548d063ce41ca","title":"curl -L https://github.com/docker/compose/releases/download/1.21.1/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose"}],"id":"17bba3633e0db487","title":"文件下载"},{"parent":"2c37a04242447d08","children":[{"parent":"06b952077c71db75","children":[],"id":"6fec1345f938a554","title":"cp -p docker-compose /usr/local/bin/"}],"id":"06b952077c71db75","title":"复制"},{"parent":"2c37a04242447d08","children":[{"parent":"03512c7ebc33cfa4","children":[],"id":"ca67540dc20ec6c5","title":"chmod +x /usr/local/bin/docker-compose"}],"id":"03512c7ebc33cfa4","title":"赋予权限"},{"parent":"2c37a04242447d08","children":[{"parent":"e8860d9d2a4cb627","children":[],"id":"326fd65181a3d7ea","title":"docker-compose --version"}],"id":"e8860d9d2a4cb627","title":"查看版本"},{"parent":"2c37a04242447d08","children":[{"parent":"4a7dc9b3dca282ec","children":[{"parent":"d7cebb61f000ff9b","children":[],"id":"947d9ff177490071","title":"mkdir nginx"},{"parent":"d7cebb61f000ff9b","children":[{"parent":"9a3e0ff365f85cd1","children":[{"parent":"722e1db523c71fe8","children":[],"id":"637df71ef5eda1be","title":"#基于基础镜像<br>FROM centos:7<br>#用户信息<br>MAINTAINER this is nginx image<br>#添加环境包<br>RUN yum -y update<br>RUN yum -y install pcre-devel zlib-devel gcc gcc-c++ make<br>RUN useradd -M -s /sbin/nologin nginx<br>#解压源码包<br>ADD nginx-1.12.0.tar.gz /usr/local/src<br>WORKDIR /usr/local/src<br>#配置<br>WORKDIR nginx-1.12.0<br>RUN ./configure \\<br>--prefix=/usr/local/nginx \\<br>--user=nginx \\<br>--group=nginx \\<br>--with-http_stub_status_module &amp;&amp; make &amp;&amp; make install<br>#环境变量<br>ENV PATH /usr/local/nginx/sbin:$PATH<br>#暴露端口<br>EXPOSE 80<br>EXPOSE 443<br>RUN echo \"daemon off;\"&gt;&gt;/usr/local/nginx/conf/nginx.conf<br>#添加启动文件到容器中<br>ADD run.sh /run.sh<br>RUN chmod 755 /run.sh<br>#容器启动自动开启服务<br>CMD [\"/run.sh\"]<br>"}],"id":"722e1db523c71fe8","title":"创建Dockerfile"},{"parent":"9a3e0ff365f85cd1","children":[{"parent":"c711578042c1542e","children":[],"id":"9c1922d1f8775b6a","title":"#!/bin/bash<br>/usr/local/nginx/sbin/nginx"}],"id":"c711578042c1542e","title":"创建服务启动脚本"},{"parent":"9a3e0ff365f85cd1","children":[],"id":"aa59a712d6d7a31f","title":"导入nginx的软件包"}],"id":"9a3e0ff365f85cd1","title":"cd nginx"}],"id":"d7cebb61f000ff9b","title":"创建工作目录"},{"parent":"4a7dc9b3dca282ec","children":[{"parent":"f890661a7b168fad","children":[],"id":"4abf46c310dcc5ac","title":"yum install tree -y"},{"parent":"f890661a7b168fad","image":{"w":300,"h":127.67624020887729,"url":"https://cdn.processon.com/userId2-667bb81a799a7b10808e5768?e=1719387691&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:jx5Xp6giwKoUoWPZqfwwJ5cXYz0=","direction":"up"},"children":[],"id":"47e42db7873a6e64","title":""}],"id":"f890661a7b168fad","title":"安装查看结构数的软件包"},{"parent":"4a7dc9b3dca282ec","children":[{"parent":"972a4525636d3a2d","children":[{"parent":"d81f44dfc5d5d20f","children":[],"id":"330986dcab26d4a6","title":"version: '3'<br>services:<br>&nbsp; nginx:<br>&nbsp; &nbsp; hostname: nginx<br>&nbsp; &nbsp; build:<br>&nbsp; &nbsp; &nbsp; context: ./nginx<br>&nbsp; &nbsp; &nbsp; dockerfile: Dockerfile<br>&nbsp; &nbsp; ports:<br>&nbsp; &nbsp; &nbsp;- 1218:80<br>&nbsp; &nbsp; &nbsp;- 1219:443<br>&nbsp; &nbsp; networks:<br>&nbsp; &nbsp; &nbsp;- cluster<br>&nbsp; &nbsp; volumes:<br>&nbsp; &nbsp; &nbsp;- ./wwwroot:/usr/local/nginx/html<br>networks:<br>&nbsp; cluster:<br>"}],"id":"d81f44dfc5d5d20f","title":"vim docker-compose.yml"}],"id":"972a4525636d3a2d","title":"编辑容器编排"},{"parent":"4a7dc9b3dca282ec","children":[{"parent":"509534ee686e19b1","children":[],"id":"d770a59bfb5bc2f4","title":"mkdir wwwroot"},{"parent":"509534ee686e19b1","children":[],"id":"88af1c98478a4279","title":"cd wwwroot"},{"parent":"509534ee686e19b1","children":[{"parent":"185332b47d27123b","children":[],"id":"6202cdc955293c6e","title":"vim index.html"},{"parent":"185332b47d27123b","image":{"w":300,"h":33.42857142857143,"url":"https://cdn.processon.com/userId2-667bbb4fea45566862fd39aa?e=1719388511&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:yehSITEvxh8jgFf1o-OyDOkkn2o=","direction":"up"},"children":[],"id":"88df7fde9ce6e507","title":""}],"id":"185332b47d27123b","title":"创建网页"}],"id":"509534ee686e19b1","title":"创建wwwroot目录"},{"parent":"4a7dc9b3dca282ec","children":[{"parent":"c925a2fa97189a61","children":[],"id":"ea81bd85db2fa8f7","title":"docker-compose -f docker-compose.yml up -d"}],"id":"c925a2fa97189a61","title":"开始编排"},{"parent":"4a7dc9b3dca282ec","children":[{"parent":"525d8a2295f0f41c","children":[],"id":"4b9422d86a43e618","title":"docker ps -a"},{"parent":"525d8a2295f0f41c","children":[],"id":"ae659f442fcbb9fc","title":"docker images"},{"parent":"525d8a2295f0f41c","children":[{"parent":"4c0c9bfa9debb9b7","children":[{"parent":"0eaa4318d5fd6b53","image":{"w":300,"h":59.55223880597015,"url":"https://cdn.processon.com/userId2-667bc08f6091d32775da7b23?e=1719389855&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:Vkat77FJfFx5x_N3BtrGvVJk4gA=","direction":"up"},"children":[],"id":"d72a9b8e815f3320","title":""}],"id":"0eaa4318d5fd6b53","title":"192.168.203.164:1218"}],"id":"4c0c9bfa9debb9b7","title":"访问浏览器"},{"parent":"525d8a2295f0f41c","children":[],"id":"31c672cbf4274073","title":"修改/wwwroot中的网站"},{"parent":"525d8a2295f0f41c","children":[{"parent":"4749141fd7ac6fb6","children":[{"parent":"2e9bba6a4640cabb","image":{"w":300,"h":62.89592760180995,"url":"https://cdn.processon.com/userId2-667bc0a7eb09963e9fce30e6?e=1719389880&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:Qabwz3dP1ko1y79emmGvdYU4KmA=","direction":"up"},"children":[],"id":"cc62538a8bf05178","title":""}],"id":"2e9bba6a4640cabb","title":"192.168.203.164:1218"}],"id":"4749141fd7ac6fb6","title":"再次访问浏览器"}],"id":"525d8a2295f0f41c","title":"查看是否成功"}],"id":"4a7dc9b3dca282ec","title":"用compose编排nginx&nbsp; &nbsp;在/compose_nginx目录中"},{"parent":"2c37a04242447d08","children":[{"parent":"3e38dc37b3f13938","children":[{"parent":"b37b75fa3bf73f71","children":[],"id":"7384401a4b16dcdd","title":"cd ~"}],"id":"b37b75fa3bf73f71","title":"进入到 root目录"},{"parent":"3e38dc37b3f13938","children":[],"id":"02a77bba5f4ba44a","title":"传入harbor镜像仓库的软件包"},{"parent":"3e38dc37b3f13938","children":[],"id":"490a44711fcc91a2","title":"前置条件，需要docker-compose"},{"parent":"3e38dc37b3f13938","children":[{"parent":"2ad0d4947649b038","children":[],"id":"6524cb6a54a405df","title":"tar zvxf harbor-offline-installer-v2.8.2.tgz -C /usr/local"}],"id":"2ad0d4947649b038","title":"解压压缩包"},{"parent":"3e38dc37b3f13938","children":[{"parent":"3b5e7ad7306676d5","children":[],"id":"ae768256ce1a7063","title":"cd /usr/local/harbor/"}],"id":"3b5e7ad7306676d5","title":"进入harbor仓库目录"},{"parent":"3e38dc37b3f13938","children":[{"parent":"7f23606c89c49d2a","children":[],"id":"a969311456f5d33e","title":"cp -p harbor.yml.tmpl harbor.yml"}],"id":"7f23606c89c49d2a","title":"复制一份配置文件"},{"parent":"3e38dc37b3f13938","children":[{"parent":"a25a59dfa7ef48ba","children":[],"id":"6f33bef201cc087b","title":"vim harbor.yml"},{"parent":"a25a59dfa7ef48ba","image":{"w":300,"h":32.78145695364238,"url":"https://cdn.processon.com/userId2-667bc21b5feedb5772d3e36c?e=1719390251&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:jGuMxFibnMRBz8QBYcsAvmpj0Yo=","direction":"up"},"children":[],"id":"9366d5f82877e2f0","title":"<br>"},{"parent":"a25a59dfa7ef48ba","image":{"w":300,"h":26.345609065155806,"url":"https://cdn.processon.com/userId2-667bc235799a7b10808e594c?e=1719390277&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:I2rEW97M8J5-CsVtIQAKPjtLxQA=","direction":"up"},"children":[],"id":"7643ed43d597080f","title":""},{"parent":"a25a59dfa7ef48ba","image":{"w":300,"h":165.8590308370044,"url":"https://cdn.processon.com/userId2-667bc24fb4912d5cc509f372?e=1719390303&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:PHOKDh5NHSybiJLTvY58FfXVfzI=","direction":"up"},"children":[],"id":"87396f25fa92ba44","title":""}],"id":"a25a59dfa7ef48ba","title":"修改harbor.yml"},{"parent":"3e38dc37b3f13938","children":[{"parent":"bb9ab422654bf2b1","children":[],"id":"ea59610dbcd3e029","title":"docker load -i harbor.v2.8.2.tar.gz"}],"id":"bb9ab422654bf2b1","title":"导入镜像"},{"parent":"3e38dc37b3f13938","children":[{"parent":"7c2e6e33fd2daa16","children":[{"parent":"d1208e85a84495c2","image":{"w":300,"h":110.35422343324251,"url":"https://cdn.processon.com/userId2-667bc2f35f0f057bc67d20b2?e=1719390467&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:EZHKWi9OAvjgIqIKKLur1mBlzdk=","direction":"up"},"children":[],"id":"9884b3a705d8616f","title":""}],"id":"d1208e85a84495c2","title":"docker images"}],"id":"7c2e6e33fd2daa16","title":"查看镜像"},{"parent":"3e38dc37b3f13938","children":[{"parent":"d602979a22b91a6a","children":[],"id":"2283e6ce17ab00e4","title":"./install.sh"}],"id":"d602979a22b91a6a","title":"使用安装脚本"},{"parent":"3e38dc37b3f13938","children":[{"parent":"dc558e61f22291ce","children":[{"parent":"2d5fbc6371b63092","children":[],"id":"c4532b15ea45f5f3","title":"输入账号密码 admin&nbsp; 123456"}],"id":"2d5fbc6371b63092","title":"http://192.168.203.164/"},{"parent":"dc558e61f22291ce","children":[],"id":"0cf97cd4280dc34b","title":"可以创建一个私有的镜像仓库，利用可视化"}],"id":"dc558e61f22291ce","title":"在浏览器中打开"},{"parent":"3e38dc37b3f13938","children":[{"parent":"1ac654140469edaf","children":[],"id":"a9bfcd467be4fa55","title":"docker login -u admin -p 123456 http://127.0.0.1"}],"id":"1ac654140469edaf","title":"在linux登录进去"},{"parent":"3e38dc37b3f13938","children":[{"parent":"9d434efc6883a6e8","children":[],"id":"21d1acf2b1ed66b0","title":"ocker tag tomcat:centos 127.0.0.1/xykj_web/tomcat:v1"}],"id":"9d434efc6883a6e8","title":"打标签"},{"parent":"3e38dc37b3f13938","children":[{"parent":"c5d3dac573623c3c","children":[],"id":"06b26d631a6475a7","title":"docker push 127.0.0.1/xykj_web/tomcat:v1"}],"id":"c5d3dac573623c3c","title":"推送到harbor仓库中"},{"parent":"3e38dc37b3f13938","children":[{"parent":"07bdc724bfe0bde2","children":[],"id":"a73b36886bc6f7ce","title":"vim /usr/lib/systemd/system/docker.service"},{"parent":"07bdc724bfe0bde2","image":{"w":300,"h":27.70448548812665,"url":"https://cdn.processon.com/userId2-667bc5cf73373a23c407dbbb?e=1719391199&token=trhI0BY8QfVrIGn9nENop6JAc6l5nZuxhjQ62UfM:Pt2mw-oN9dM6Var2eE9otxZji40=","direction":"up"},"children":[],"id":"f45e0af95baf0817","title":"修改内容可以访问远程docker镜像仓库"},{"parent":"07bdc724bfe0bde2","children":[{"parent":"67cb8567510f0c55","children":[],"id":"e9aad6159f150d92","title":"systemctl daemon-reload"},{"parent":"67cb8567510f0c55","children":[],"id":"5a155cc1e801099b","title":"systemctl restart docker"}],"id":"67cb8567510f0c55","title":"重启容器和服务"},{"parent":"07bdc724bfe0bde2","children":[{"parent":"8c28b51f93c2de71","children":[],"id":"5ca8205ae64ed1fd","title":"docker login -u admin -p 123456 http://192.168.203.164"}],"id":"8c28b51f93c2de71","title":"登录远程仓库"}],"id":"07bdc724bfe0bde2","title":"创建一个客户端docker来访问该仓库"}],"id":"3e38dc37b3f13938","title":"harbor镜像仓库 以web页面形式呈现"}],"collapsed":false,"id":"2c37a04242447d08","title":"容器编排技术compose"}],"root":true,"theme":"gsx_notes_yellow","showWatermark":false,"id":"root","title":"Docker","version":829,"structure":"mind_right"}},"meta":{"exportTime":"2024-08-01 12:38:47","member":"","diagramInfo":{"creator":"","created":"2024-06-24 09:19:47","modified":"2024-06-26 15:43:40","title":"Docker","category":"mind_free"},"id":"6678c9b385a0e02eedfacb28","type":"ProcessOn Schema File","version":"5.0"}}